<!DOCTYPE html>
<html>
<head>
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">

  <!-- LeafletJS CSS dependencies-->
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" />
  <link rel="stylesheet" href="./scripts/lib/L.Control.Locate.min.css" />

  <!-- LeafletJS dependencies-->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
			 integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
			 crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"
		 integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
		 crossorigin=""></script>


</head>
<body>
  <div v-cloak id="app">
    <v-app>
        <v-container>
				<v-app-bar app color="indigo" dark>

						<v-toolbar-title>Welp</v-toolbar-title>
						<v-spacer></v-spacer>
			
						<v-dialog v-model="loginDialog" persistent max-width="600px">
							<template v-slot:activator="{ on }">
								<v-btn v-if="!loggedIn" dark v-on="on">Login</v-btn>
							</template>
							<v-card>
								<v-card-title>
									<span class="headline">Login</span>
									<v-spacer></v-spacer>
									<v-btn color="red" text @click="exitLogin()"><v-icon>mdi-close</v-icon></v-btn>
								</v-card-title>
								<v-card-text>
									<v-container>
										<span class="red--text subtitle-1 font-weight-bold">{{loginCaption}}</span>
										<v-row>
											<v-col cols="12" sm="6" >
												<v-card class="pa-2" outlined >
													<span>Login</span>
		
													<v-text-field label="Username*" :maxlength="50" v-model="logInUsername" required></v-text-field>
													<v-text-field label="Password*" :maxlength="200" v-model="logInPass" type="password" required></v-text-field>
												</v-card>
											</v-col>
											<v-col cols="12" sm="6">
												<v-card class="pa-2" outlined>
													<span>Register</span>
		
													<v-text-field label="Username*" :maxlength="50" v-model="registerUsername" required></v-text-field>
													<v-text-field label="Password*" :maxlength="200" v-model="registerPass" type="password" required></v-text-field>
													<v-text-field label="Password again*" :maxlength="200" v-model="registerPassAgain" type="password" required></v-text-field>
												</v-card>
											</v-col>
										</v-row>
			
										<small>*indicates required field</small>
									</v-container>
			
								</v-card-text>
								<v-card-actions>
									<v-row style="text-align:center">
										<v-col cols="12" sm="6">
											<v-btn color="blue darken-1" text @click="login()" class="justify-center">Login</v-btn>
										</v-col>
										<v-col cols="12" sm="6">
											<v-btn color="blue darken-1" text @click="registerUser()" class="justify-center">Register</v-btn>
										</v-col>
									</v-row>
								</v-card-actions>
							</v-card>
						</v-dialog>
			
						<v-btn icon color="black">
							<v-icon>fa-question-circle</v-icon>
						</v-btn>
					</v-app-bar>
			
				<v-content>
					<v-container class="fill-height" fluid>
						<v-row justify="center">
							<v-col cols="12" sm="8" class="text-center">
							
								<div id="map" class="pa-2" style="width: 100%;height: 400px;" v-show="!loginDialog && !bathroomDialog"></div>

								<div v-if="loggedIn">
									<v-btn v-if="!pinOnMap"  class="mt-4 white--text" color="indigo" @click="dropPin">
										Add a Bathroom
									</v-btn>
									<v-btn v-else class="mt-4 white--text" color="indigo" @click="addBathroom">
										Enter Details
									</v-btn>
								</div>

							</v-col>
							<v-col cols="12" sm="4" style="width: 100%;">
								<v-toolbar>
									<v-toolbar-title>Bathrooms</v-toolbar-title>
									<v-spacer></v-spacer>
									<v-menu v-model="filterPopup" :close-on-content-click="false" bottom left>
										<template v-slot:activator="{ on }">
											<v-btn icon v-on="on">
												<v-icon>mdi-filter</v-icon>
											</v-btn>
										</template>
							
										<v-card class="pa-2" max-width="200px">
											<span class="title"> Filter Bathrooms</span>

											<v-select
												:items="['Single Occupancy', 'Multiple Occupancy', 'Other']"
												label="Occupancy Type"
												v-model="filterOccupancy"
												clearable
											></v-select>
															
											<v-select
												:items="['One Stall / Single Occupancy', '2-3 Stalls', '4-7 Stalls', '8+ Stalls']"
												label="Number of Stalls"
												v-model="filterStallRange"
												clearable
											></v-select>
															
											<v-select
												:items="['Men', 'Women', 'Other']"
												label="Gender Designation"
												v-model="filterGender"
												clearable
											></v-select>
															
											<v-select
												:items="['Paper Towels', 'Electric Hand Dryer', 'Electric Hand Dryer AND Paper Towels',
												'None available', 'Other']"
												label="Hand Drying"
												v-model="filterHandDrying"
												clearable
											></v-select>

											<v-btn @click="loadBathrooms">
												Filter
											</v-btn>
										</v-card>
									</v-menu>
								</v-toolbar>
								<template>
									<v-card class="mx-auto" max-width="400"  tile>
										<v-dialog v-model="bathroomDialog" scrollable  persistent max-width="500px">
											<template v-slot:activator="{ on }">
												<v-list two-line  style="overflow-y: auto; height:70vh">
														<v-list-item  v-for="bathroom in bathroomsToDisplay" two-line
														@click="displayBathroomFromList(bathroom)" v-on="on"
														>
															<v-list-item-content>
																<v-list-item-title>{{bathroom.bathroom_name}}</v-list-item-title>
																<v-list-item-subtitle>
																		<v-rating 
																		half-increments
																		readonly dense
																		v-model="bathroom.avg_overall_rating">
																		</v-rating>
																		
																</v-list-item-subtitle>
															</v-list-item-content>
														</v-list-item>
												</v-list>
											</template>
											<v-card >
												<v-card-title >
													
													<v-row>
														<div v-if="bathroomViewed !== null">
															<span  class="headline">{{bathroomViewed.bathroom_name}}</span>
														</div>
														<div v-else-if="bathroomEdited !== null" class="pa-0 ma-0">
															<span v-if="bathroomEdited.bathroom_name !== ''" class="headline">{{bathroomEdited.bathroom_name}}</span>
															<span v-else class="headline">New Bathroom</span>
														</div>
														

														<v-spacer></v-spacer>
														<v-btn color="red" text @click="exitBathroom"><v-icon>mdi-close</v-icon></v-btn>
													</v-row>

													<v-row>
														<span class="title">Average Rating: </span>
														<v-rating v-if="bathroomViewed !== null"
														half-increments
														readonly dense
														v-model="bathroomViewed.avg_overall_rating">
														</v-rating>

														<v-rating v-else-if="bathroomEdited !== null"
														half-increments
														readonly dense
														v-model="bathroomEdited.avg_overall_rating">
														</v-rating>
													</v-row>
													
												</v-card-title>
												
												<v-card-text>
													<v-container>
				
														<div v-if="editingBathroom && bathroomEdited !== null">
				
															<v-text-field
															v-model="bathroomEdited.bathroom_name"
															label="Bathroom Title" :maxlength="120"
															>
															</v-text-field>
				
															<v-textarea v-model="bathroomEdited.description" :maxlength="600">
																<template v-slot:label>
																	<div>
																		How do I get there?
																	</div>
																</template>
															</v-textarea>
				
															<v-textarea v-model="bathroomEdited.time_availability" :maxlength="300">
																<template v-slot:label>
																	<div>
																		At what times can I use it?
																	</div>
																</template>
															</v-textarea>
				
															<v-select
																	:items="['Single Occupancy', 'Multiple Occupancy', 'Other']"
																label="Occupancy Type"
																v-model="occupancyToDisplay"
															></v-select>
															
															<v-select
																:items="['One Stall / Single Occupancy', '2-3 Stalls', '4-7 Stalls', '8+ Stalls']"
																label="Number of Stalls"
																v-model="stallNumberToDisplay"
															></v-select>
															
															<v-select
																	:items="['Gender Agnostic', 'Men', 'Women', 'Other']"
																label="Gender Designation"
																v-model="genderToDisplay"
															></v-select>
															
															<v-select
																	:items="['Paper Towels', 'Electric Hand Dryer', 'Electric Hand Dryer AND Paper Towels',
																	'None available', 'Other']"
																label="Hand Drying"
																v-model="handDryingToDisplay"
															></v-select>
															
															<v-textarea v-model="bathroomEdited.notes" :maxlength="600">
																<template v-slot:label>
																	<div>
																		Additional Notes
																	</div>
																</template>
															</v-textarea>

															<v-layout justify-center>
																<v-card-actions>
																	<v-btn  @click="saveBathroom">Save Bathroom</v-btn>
																</v-card-actions>
															</v-layout>
									
														</div>
														<div v-else-if="bathroomViewed !== null">

															<p class="subtitle-1 black--text">{{bathroomViewed.description}}</p>

															<v-row>
																<v-col cols="12" sm="6" >
																	<span class="title">Cleanliness: 

																		<div v-if="loggedIn">
																			<v-rating
																			half-increments
																			medium dense
																			@input="rateBathroom('cleanliness')"
																			v-model="cleanlinessToDisplay">
																			</v-rating>
																		</div>
																		<div v-else>
																			<v-rating 
																			half-increments
																			readonly medium dense
																			v-model="bathroomViewed.avg_ratings.cleanliness">
																			</v-rating>
																		</div>
										
																	</span>
																</v-col>
																<v-col cols="12" sm="6">
																	<span class="title">Privacy: 
																		<div v-if="loggedIn">
																			<v-rating 
																			half-increments
																			medium dense
																			@input="rateBathroom('privacy')"
																			v-model="privacyToDisplay">
																			</v-rating>
																		</div>
																		<div v-else>
																			<v-rating
																			half-increments
																			readonly medium dense
																			v-model="bathroomViewed.avg_ratings.privacy">
																			</v-rating>
																		</div>
																	</span>
																</v-col>
															</v-row>
															<v-row>
																<v-col cols="12" sm="6" >
																	<span class="title">Atmosphere: 
																		<div v-if="loggedIn">
																			<v-rating
																			half-increments
																			medium dense
																			@input="rateBathroom('atmosphere')"
																			v-model="atmosphereToDisplay">
																			</v-rating>
																		</div>
																		<div v-else>
																			<v-rating 
																			half-increments
																			readonly medium dense
																			v-model="bathroomViewed.avg_ratings.atmosphere">
																			</v-rating>
																		</div>
																	</span>
																</v-col>
																<v-col cols="12" sm="6">
																	<span class="title">Accessibility: 
																		<div v-if="loggedIn">
																			<v-rating 
																			half-increments
																			medium dense
																			@input="rateBathroom('accessibility')"
																			v-model="accessibilityToDisplay">
																			</v-rating>
																		</div>
																		<div v-else>
																			<v-rating
																			half-increments
																			readonly medium dense
																			v-model="bathroomViewed.avg_ratings.accessibility">
																			</v-rating>
																		</div>
																	</span>
																</v-col>
															</v-row>
															<div v-if="bathroomViewed.time_availability != null">
																<p class="title">When is this bathroom available for use?</p>
																<p class="subtitle-1 black--text">{{bathroomViewed.time_availability}}</p>
															</div>
															<div v-if="genderToDisplay !== ''">
																<p class="title">Is this bathroom for a certain gender?</p>
																<p class="subtitle-1 black--text">{{genderToDisplay}}</p>
															</div>
															<div v-if="occupancyToDisplay !== ''">
																<p class="title">Is this a single-occupancy bathroom?</p>
																<p class="subtitle-1 black--text">{{occupancyToDisplay}}</p>
															</div>
															<div v-if="stallNumberToDisplay !== '' && occupancyToDisplay !== 'Single occupancy'">
																<p class="title" >How many stalls does this bathroom have?</p>
																<p class="subtitle-1 black--text">{{stallNumberToDisplay}}</p>
															</div>
															<div v-if="handDryingToDisplay !== ''">
																<p class="title">What kind of hand-drying does this bathroom have?</p>
																<p class="subtitle-1 black--text">{{handDryingToDisplay}}</p>
															</div>
															<div v-if="bathroomViewed.notes !== null">
																<p class="title">Additional Notes:</p>
																<p class="subtitle-1 black--text">{{bathroomViewed.notes}}</p>
															</div>

															<v-layout justify-center>
																<v-card-actions>
																	<v-btn  v-if="loggedIn" @click="editBathroom">Edit Bathroom</v-btn>
																</v-card-actions>
															</v-layout>

														</div>
													</v-container>
												</v-card-text>
											</v-card>
										</v-dialog>
									</v-card>
								</template>
							</v-col>
						</v-row>
				</v-content>
        </v-container>
    </v-app>
  </div>
  


  <!-- Vue/Vuetify dependencies -->
  <script src="../scripts/lib/vue.js"></script>
  <script src="../scripts/lib/vuetify.js"></script>

  <!-- Leaflet/Locate Control dependencies-->
  <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet-src.js"></script>
  <script src="../scripts/lib/L.Control.Locate.js" ></script>

  <!-- Axios dependency -->
  <script src="../scripts/lib/axios.min.js"></script>




  <script> var exports = {}; </script>
  <script src='../scripts/app.js'></script>
</body>
</html>